package modelo;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

import com.mysql.jdbc.Connection;
import utilidades.ConectarV;

public class DAO {

	private Connection conexion;

	public DAO(String base) {
		ConectarV c = new ConectarV(base);
		this.conexion = c.getConexion();
	}

	private void desconectar() throws SQLException {
		this.conexion.close();
	}

	public ArrayList<Palabras> buscar () throws SQLException { 
		ArrayList<Palabras> p = new ArrayList<Palabras>(); 
		
		String query = "SELECT * FROM palabras order by votos desc";
		System.out.println(query);
		PreparedStatement s;
		s = this.conexion.prepareStatement(query);
		ResultSet rs = s.executeQuery();
		
		while (rs.next()) {
			p.add(new Palabras(rs.getString(1), rs.getInt(2))); 
		}
		
		rs.close();
		desconectar();
		return p;
	}
	
	 public void insertarPalabra(String campo1) throws SQLException {
		String query = "INSERT INTO palabras (palabra, votos) VALUES (?, 1)";
		System.out.println(query);
		PreparedStatement s;
		try {
			s = this.conexion.prepareStatement(query);
			s.setString(1, campo1);
			
			int filas = s.executeUpdate();
			System.out.println(filas);
		} catch (SQLException e) {
			System.out.println(e.getMessage());
		}
		
		desconectar();
	 }
	 
	 public String modificar(Palabras es) throws SQLException {
			int nreg;
			Statement s;
			String error = "";
			String query = "update especialidades set votos = "+ es.getVotos() +" where palabra = "+es.getPalabra()+" ";
			s = this.conexion.createStatement();
			try {
				nreg=s.executeUpdate(query);
				error = String.valueOf(nreg);
				s.close();
				desconectar();
			} catch (SQLException e1) {
				error = e1.getMessage();
			}
			return error;
		}
}
